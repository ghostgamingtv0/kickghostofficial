<!-- Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙƒÙ…Ø§ Ù‚Ø¨Ù„ØŒ ØºÙŠØ± Ø§Ù„Ø¬Ø²Ø¡ JS ØºØ§Ø¯ÙŠ Ù†Ø­Ø¯Ø«ÙˆÙ‡ -->

<script>
// ===== Language Toggle =====
let lang = 'en';
function toggleLang(){
  lang = lang==='en'?'ar':'en';
  document.getElementById('kick-btn').innerText = lang==='en' ? 'Step 1: Login with Kick ğŸ¥' : 'Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± ÙƒÙŠÙƒ';
  document.getElementById('kick-text').innerText = lang==='en' ? 'Step 1: Login via Kick' : 'Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
  document.getElementById('instr-title').innerText = lang==='en' ? 'How to add $KICKGHOST' : 'ÙƒÙŠÙÙŠØ© Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„Ø© $KICKGHOST';
  document.getElementById('instr-en').style.display = lang==='en'?'block':'none';
  document.getElementById('instr-ar').style.display = lang==='en'?'none':'block';
}

// ===== Kick Login =====
document.getElementById("kick-btn").onclick = () => {
  const kID = "01KDYM8ZRHB8W24HFJ8YEQ1Q55";
  const redirect = location.origin + location.pathname;
  window.location.href = `https://kick.com/oauth/authorize?client_id=${kID}&redirect_uri=${encodeURIComponent(redirect)}&response_type=code&scope=user:read%20channel:read%20chat:write`;
};

// ===== Multi Wallet Connect =====
let connectedAddress = "";
async function connectWallet(type){
  const m = document.getElementById("wallet-msg");
  try{
    m.innerText = lang==='en' ? "CONNECTING..." : "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...";
    let wallet;
    if(type==='MetaMask') wallet = new window.Thirdweb.MetaMaskWallet();
    else if(type==='WalletConnect') wallet = new window.Thirdweb.WalletConnectWallet();
    else if(type==='CoinbaseWallet') wallet = new window.Thirdweb.CoinbaseWallet();
    else throw new Error("Wallet type not supported");

    await wallet.connect();
    connectedAddress = await wallet.getAddress();
    m.innerText = lang==='en' ? "SUCCESS âœ… Connected: "+connectedAddress.substring(0,10) : "âœ… ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„: "+connectedAddress.substring(0,10);
    m.className = "mt-4 text-green-400 font-bold";

    saveUser(connectedAddress);
  }catch(e){
    m.innerText = "âŒ ERROR: "+e.message;
    m.className = "mt-4 text-red-500 font-bold text-xs";
  }
}

// ===== LocalStorage Users =====
function saveUser(addr){
  let users = JSON.parse(localStorage.getItem("kg_users")||"[]");
  if(!users.includes(addr)) users.push(addr);
  localStorage.setItem("kg_users", JSON.stringify(users));
  renderUsers();
}
function renderUsers(){
  const users = JSON.parse(localStorage.getItem("kg_users")||"[]");
  document.getElementById("users").innerHTML = users.map(u=>`<div class="box">${u}</div>`).join("");
}
renderUsers();

// ===== Network Switch + Airdrop =====
const AIRDROP_TOKEN = "0x539A66654cf4e71cB7207ac6B3A56B789FBcbFce";
const AIRDROP_AMOUNT = "1000000000000000000000"; // 1000 Tokens, 18 decimals
const POLYGON_CHAIN_ID = "0x89"; // Polygon Mainnet

async function claimAirdrop(){
  const msg = document.getElementById("airdrop-msg");
  if(!connectedAddress){ msg.innerText = lang==='en'?"Connect wallet first!":"Ø±Ø¨Ø· Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹!"; return; }

  try{
    const provider = new ethers.providers.Web3Provider(window.ethereum);
    const network = await provider.getNetwork();
    if(network.chainId !== 137){ // 137 = Polygon Mainnet
      // Switch Network
      await window.ethereum.request({
        method: 'wallet_switchEthereumChain',
        params: [{ chainId: POLYGON_CHAIN_ID }]
      });
    }

    const signer = provider.getSigner();
    const contract = new ethers.Contract(AIRDROP_TOKEN,
      ["function transfer(address to,uint256 amount) public returns (bool)"],
      signer
    );

    await contract.transfer(connectedAddress, AIRDROP_AMOUNT);
    msg.innerText = lang==='en'?"âœ… Airdrop claimed!":"âœ… ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Airdrop!";
    msg.style.color = "#53fc18";
  }catch(e){
    msg.innerText = "âŒ "+e.message;
    msg.style.color = "#f00";
  }
}
</script>
